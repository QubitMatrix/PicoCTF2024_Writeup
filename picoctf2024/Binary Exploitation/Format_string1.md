
# Description
Patrick and Sponge Bob were really happy with those orders you made for them, but now they're curious about the secret menu. Find it, and along the way, maybe you'll find something else of interest!   
Download the binary [here](https://artifacts.picoctf.net/c_mimas/43/format-string-1).   
Download the source [here](https://artifacts.picoctf.net/c_mimas/43/format-string-1.c).

Additional details will be available after launching your challenge instance.

# Solution
- The first step is to check the executable to check if it is 64 or 32 bit as given in the hint
- Since our goal is to read details from the server and not write or crash the server we will use %x to reveal data
- Using `file` command we can find that it is a 64 bit executable hence a word would consist of 8 bytes -> Use %lx instead of %x which reads only 4 bytes
- When the code is analysed we see that the input buffer is 1024 bytes. Input can be split as multiple occurrences of %8lx -> `print('%08lx'*256)` can be executed and the output can be sent as input to netcat 
- The values are in hexadecimal format hence decode it using cyberchef or any tool to get ascii equivalent -> a clear ascii text can be seen amidst other unicodes which is the flag
- This flag is in little endian format since the executable is little endian -> can be inferred by using `exiftool`
- The flag will be reversed every 8 letters since it is little endian and 64 bit 
- Script to get flag
```
s="flag from convertor"
for y in range(0,len(s),8):
    print("".join(reversed(s[y:y+8])),end="")
```

- Flag -> `picoCTF{4n1m41_57y13_4x4_f14g_<some_id>}`